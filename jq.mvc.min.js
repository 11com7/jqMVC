(function(d){d.mvc={};d.mvc.app=function(){return{_loadTimer:null,_modelsReady:!1,_controllersReady:!1,_loadedListeners:[],_modelsLoaded:0,_totalModels:0,_controllersDir:"controllers/",_modelsDir:"models/",listenHashChange:function(){window.addEventListener("hashchange",function(a){var b=document.location.hash.replace("#","/");d.mvc.route(b,a)})},controllersDir:function(a){this._controllersDir=a},modelsDir:function(a){this._modelsDir=a},setViewType:function(a){d.mvc._app._templateType=a},ready:function(a){if(this.loaded)a();
else d(document).one("jqmvc:loaded",a)},loadControllers:function(a){var b=this;d(document).ready(function(){b._loadTimer=setTimeout(function(){b._modelsReady=!0;b._controllersReady&&d(document).trigger("jqmvc:loaded")},1500);typeof a==="string"&&(a=[a]);for(var c=0;c<a.length;c++){var g=document.createElement("script");g.src=b._controllersDir+a[c]+".js";g.onerror=function(a){console.log("error ",a)};d("head").append(g);b._loadedListeners[a[c]]=1;b._loadedListeners.length++;d(document).one(a[c]+":ready",
function(a){delete b._loadedListeners[a.data.name];b._loadedListeners.length--;if(b._loadedListeners.length==0)b._controllersReady=!0,b._modelsReady&&d(document).trigger("jqmvc:loaded")});delete g}})},loadModels:function(a){var b=this;clearTimeout(this._loadTimer);d(document).ready(function(){typeof a==="string"&&(a=[a]);b._totalModels=a.length;for(var c=0;c<a.length;c++){var g=document.createElement("script");g.src=b._modelsDir+a[c]+".js";g.onload=function(){b._modelsLoaded++;if(b._modelsLoaded>=
b._totalModels)b._modelsReady=!0,b._controllersReady&&d(document).trigger("jqmvc:loaded")};g.onerror=function(a){console.log("error ",a)};d("head").append(g);delete g}})}}};d.mvc._app={_templateType:"text/html"};var e=document.location.protocol+"//"+document.location.host,h=[],i={},b={},c={};d.mvc.controller={};d.mvc.controller.create=function(a,f){var j=!0;d.mvc.controller[a]=f;i[a]=0;b[a]=0;f.hasOwnProperty("init")&&(c[a]=f);if(f.hasOwnProperty("views")&&(f.views.length>0||Object.keys(f.views).length)>
0)for(var g in j=!1,i[a]=f.views.length||Object.keys(f.views).length,f.views){var e=d.isArray(f.views)?f.views[g]:g;!h[e]&&jq("#"+e).length==0&&(d.mvc.controller.addView(f.views[g],a,e),h[e]=1)}j&&(d(document).trigger(a+":ready",{name:a}),c[a]&&c[a].init.apply(c[a]));return d.mvc.controller[a]};d.mvc.route=function(a,b){var c,g;a.indexOf(e)===0&&(a=a.substring(e.length,a.length));a[0]=="/"&&(a=a.substr(1));a[a.length-1]=="/"&&(a=a.slice(0,-1));a=a.split("/");a.length>1?(c=a.splice(0,1),g=a.splice(0,
1)):(c=a[0],g="default");if(d.mvc.controller[c]&&d.mvc.controller[c].hasOwnProperty(g))return b&&b.preventDefault(),d.mvc.controller[c][g].apply(d.mvc.controller[c],a),!0;return!1};d.mvc.addRoute=function(a,b){a.indexOf(e)===0&&(a=a.substring(e.length,a.length));a[0]=="/"&&(a=a.substr(1));a=a.split("/");if(a.length>1)var c=a.splice(0,1),g=a.splice(0,1);else c=a[0],g="default";d.mvc.controller[c]||(d.mvc.controller[c]={});d.mvc.controller[c][g]=b};d.mvc.controller.addView=function(a,f,e){d.get(a,function(a){d(document.body).append(d("<script type='"+
d.mvc._app._templateType+"' id='"+e+"'>"+a+"<\/script>"));b[f]++;b[f]==i[f]&&(d(document).trigger(f+":ready",{name:f}),c[f]&&c[f].init.apply(c[f]))})};if(d.ui)d.ui.customClickHandler=d.mvc.route;else d(document).on("click","a",function(a){d.mvc.route(a.target.href,a)})})(jq);
(function(d){var e={},h={};d.mvc.model=function(b,c){c&&c.modelName&&delete c.modelName;c&&c.id&&delete c.id;h[b]||(h[b]=c);d.extend(this,c);this.modelName=b};d.mvc.model.prototype={get:function(b,c){var a=this,f=new d.mvc.model(this.modelName,h[this.modelName]);e[this.modelName].get(b,function(e){f=d.extend(f,e);f.modelName=a.modelName;f.id=b;if(c)return c(f);return f})},getAll:function(b){return e[this.modelName].getAll(this.modelName,b)},save:function(b){return e[this.modelName].save(this,b)},
remove:function(b){return e[this.modelName].remove(this,b)},set:function(b,c){if(d.isObject(b))for(var a in b&&b.modelName&&delete b.modelName,b&&b.id&&delete b.id,b)this.hasOwnProperty(a)&&(this[a]=b[a]);else b.toLowerCase()!="id"&&b.toLowerCase()!="modelname"&&(this[b]=c)}};d.mvc.model.extend=function(b,c,a){e[b]=a?a:(i.linkerCache[b]={},i);return function(){a!==void 0&&d.extend(c,a);return new d.mvc.model(b,c)}};var i={linkerCache:{},save:function(b,c){if(!b.id)b.id=d.uuid();window.localStorage.setItem(b.id,
JSON.stringify(b));this.linkerCache[b.modelName][b.id]=1;window.localStorage.setItem(b.modelName+"_linker",JSON.stringify(this.linkerCache[b.modelName]));d(document).trigger(b.modelName+":save",b);if(c)return c(b)},get:function(b,c){var a=window.localStorage.getItem(b);try{a=JSON.parse(a)}catch(d){a={}}return c(a)},getAll:function(b,c){var a=JSON.parse(window.localStorage.getItem(b+"_linker")),d=[],e;for(e in a)if(localStorage[e]){var g=JSON.parse(localStorage[e]);g.modelName=b;g.id=e;d.push(g)}else delete a[e];
this.linkerCache[b]=a?a:{};window.localStorage.setItem(b+"_linker",JSON.stringify(this.linkerCache[b]));return c(d)},remove:function(b,c){window.localStorage.removeItem(b.id);delete this.linkerCache[b.modelName][b.id];window.localStorage.setItem(b.modelName+"_linker",JSON.stringify(this.linkerCache[b.modelName]));d(document).trigger(b.modelName+":remove",b.id);if(c)return c(b)}}})(jq);
(function(d){d.template=function(b,c){return e(b,c)};d.tmpl=function(b,c){return d(e(b,c))};var e=function(b,c){c||(c={});return i(b,c)},h={},i=function c(a,d){var e=!/\W/.test(a)||/.js$/.test(a)?h[a]=h[a]||c(document.getElementById(a).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+
"');}return p.join('');");return d?e(d):e}})(jq);
